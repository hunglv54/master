define(["jquery","external/react","modules/clean/react/sprite","modules/core/exception","modules/core/i18n","modules/clean/css"],function(e,t,s,r,o,i){var l,n,a,c,u,p,m,h,C,d,N;return h=r.assert,u=o._,N=t.DOM,C=t.createElement,d=t.addons.classSet,c={ASCENDING:"ASCENDING",DESCENDING:"DESCENDING"},a={SINGLE:"SINGLE",MULTI:"MULTI"},n=t.PropTypes.shape({type:t.PropTypes.oneOf([a.SINGLE,a.MULTI]).isRequired,label:t.PropTypes.string.isRequired,sortCallback:t.PropTypes.func,switchColumnCallback:t.PropTypes.func,columns:t.PropTypes.arrayOf(t.PropTypes.shape({type:t.PropTypes.oneOf([a.SINGLE]).isRequired,label:t.PropTypes.string.isRequired}))}.isRequired),l=t.createClass({displayName:"ColumnHeader",propTypes:{columns:t.PropTypes.arrayOf(n).isRequired,className:t.PropTypes.string,css:t.PropTypes.string},getInitialState:function(){var e;return this.props.columns[0].type===a.SINGLE?e=this.props.columns[0].label:this.props.columns[0].type===a.MULTI&&(e=this.props.columns[0][0].label),{activeColumn:e,cssLoaded:!1}},componentWillMount:function(){return this.props.css?i.require_css(this.props.css,function(e){return function(){return e.setState({cssLoaded:!0})}}(this)):void 0},setActiveColumn:function(e){return this.state.activeColumn!==e?this.setState({activeColumn:e}):void 0},render:function(){var e,t;return this.state.cssLoaded?(e=function(){var e,s,r,o;for(r=this.props.columns,o=[],e=0,s=r.length;s>e;e++)t=r[e],o.push(t.type===a.SINGLE?C(m,{key:t.label,label:t.label,isSelected:t.label===this.state.activeColumn,direction:c.ASCENDING,sortCallback:t.sortCallback,setActiveColumn:this.setActiveColumn,canTriggerSortDirection:!0,className:t.headerClassName||""}):t.type===a.MULTI?C(p,{key:t.columns[0].label,columns:t.columns,setActiveColumn:this.setActiveColumn,activeColumn:this.state.activeColumn,switchColumnCallback:t.switchColumnCallback}):void 0);return o}.call(this),N.ul({role:"row",className:"col-header "+this.props.className},e)):N.ul({})}}),m=t.createClass({displayName:"_SingleColumnHeader",propTypes:{label:t.PropTypes.string.isRequired,className:t.PropTypes.string.isRequired,direction:t.PropTypes.string.isRequired,setActiveColumn:t.PropTypes.func,isSelected:t.PropTypes.bool.isRequired,sortCallback:t.PropTypes.func,canTriggerSortDirection:t.PropTypes.bool.isRequired,multiColumnClick:t.PropTypes.func,nextColumnLabel:t.PropTypes.string},getInitialState:function(){return{sortDirection:this.props.direction}},handleClick:function(e){var t;return t=c.ASCENDING,this.props.isSelected||this.state.sortDirection!==c.ASCENDING&&this.setState({sortDirection:c.ASCENDING}),this.props.canTriggerSortDirection&&this.props.isSelected&&(this.state.sortDirection===c.ASCENDING&&(t=c.DESCENDING),this.setState({sortDirection:t})),this.props.setActiveColumn&&this.props.setActiveColumn(this.props.label),this.props.sortCallback&&this.props.sortCallback(t),this.props.multiColumnClick?this.props.multiColumnClick(e):void 0},render:function(){var e,t,r,o;return this.state.sortDirection===c.DESCENDING?(o="arrow-down-gray",r="descending",e=u("Sort in ascending order")):this.state.sortDirection===c.ASCENDING&&(o="arrow-up-gray",r="ascending",e=u(this.props.isSelected?"Sort in descending order":"Sort in ascending order")),this.props.nextColumnLabel&&(e=u("Swap column to %(nextlabel)s",{comment:"nextlabel is the name of the column that the current column will be replaced with when this button is clicked."}).format({nextlabel:this.props.nextColumnLabel})),t={bolded:this.props.isSelected},N.li({role:"columnheader","aria-sort":this.props.isSelected?r:"",className:"sortable-col-header "+this.props.className},N.button({className:"col-header-button "+d(t),onClick:this.handleClick,ref:"columnButton",title:e},this.props.label,this.props.isSelected?C(s,{group:"web",name:o,alt:"",className:"sort-icon"}):void 0))}}),p=t.createClass({displayName:"_MultiColumnHeader",propTypes:{columns:t.PropTypes.arrayOf(n).isRequired,activeColumn:t.PropTypes.string.isRequired,setActiveColumn:t.PropTypes.func.isRequired,switchColumnCallback:t.PropTypes.func},getInitialState:function(){return{currentColumn:0,columnCount:this.props.columns.length}},handleClick:function(){var e;return e=(this.state.currentColumn+1)%this.state.columnCount,this.setState({currentColumn:e},function(e){return function(){return e.refs.singleColumn.refs.columnButton.getDOMNode().focus()}}(this)),this.props.setActiveColumn(this.props.columns[e].label),this.props.switchColumnCallback(e)},render:function(){var e,t;return e=this.state.currentColumn,t=(this.state.currentColumn+1)%this.state.columnCount,C(m,{canTriggerSortDirection:!1,className:this.props.columns[this.state.currentColumn].headerClassName||"",direction:c.ASCENDING,isSelected:this.props.columns[e].label===this.props.activeColumn,key:this.props.columns[e].label,label:this.props.columns[e].label,multiColumnClick:this.handleClick,nextColumnLabel:this.props.columns[t].label,ref:"singleColumn",sortCallback:this.props.columns[t].sortCallback})}}),{ColumnHeader:l,SortDirections:c,ColumnTypes:a}});